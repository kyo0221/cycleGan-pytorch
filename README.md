# cycleGAN-pytorch

å¤©å€™å¤‰æ›ï¼ˆæ™´ã‚Œâ‡”æ›‡ã‚Šï¼‰ã‚’è¡Œã†CycleGANã®PyTorchå®Ÿè£…ã§ã™ã€‚æ•™å¸«ãªã—å­¦ç¿’ã«ã‚ˆã‚Šã€ãƒšã‚¢ç”»åƒãªã—ã§ç”»åƒã‹ã‚‰ç”»åƒã¸ã®å¤‰æ›ã‚’å®Ÿç¾ã—ã¾ã™ã€‚

## æ¦‚è¦

CycleGANã¯ã€å¯¾å¿œã™ã‚‹ãƒšã‚¢ç”»åƒãŒãªã„çŠ¶æ³ã§ã€ã‚ã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ç”»åƒã‚’åˆ¥ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ç”»åƒã«å¤‰æ›ã™ã‚‹æ·±å±¤å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã§ã™ã€‚ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€ç‰¹ã«å¤©å€™å¤‰æ›ï¼ˆæ™´å¤©â†”æ›‡å¤©ï¼‰ã«ç‰¹åŒ–ã—ãŸå®Ÿè£…ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚

## ã‚µãƒ³ãƒ—ãƒ«çµæœ

### ğŸŒ æ™´ã‚Œ â†’ æ›‡ã‚Šå¤‰æ› (Sunny to Cloudy)

| ã‚µãƒ³ãƒ—ãƒ«1 | ã‚µãƒ³ãƒ—ãƒ«2 | ã‚µãƒ³ãƒ—ãƒ«3 |
|:---:|:---:|:---:|
| **å¤‰æ›å‰** | **å¤‰æ›å‰** | **å¤‰æ›å‰** |
| ![Sunny1](samples/sunny2cloudy/sunny_01.png) | ![Sunny2](samples/sunny2cloudy/sunny_02.png) | ![Sunny3](samples/sunny2cloudy/sunny_03.png) |
| **å¤‰æ›å¾Œ** | **å¤‰æ›å¾Œ** | **å¤‰æ›å¾Œ** |
| ![Cloudy1](samples/sunny2cloudy/cloudy_01.png) | ![Cloudy2](samples/sunny2cloudy/cloudy_02.png) | ![Cloudy3](samples/sunny2cloudy/cloudy_03.png) |

### â˜ï¸ æ›‡ã‚Š â†’ æ™´ã‚Œå¤‰æ› (Cloudy to Sunny)

| ã‚µãƒ³ãƒ—ãƒ«1 | ã‚µãƒ³ãƒ—ãƒ«2 | ã‚µãƒ³ãƒ—ãƒ«3 |
|:---:|:---:|:---:|
| **å¤‰æ›å‰** | **å¤‰æ›å‰** | **å¤‰æ›å‰** |
| ![Cloudy1](samples/cloudy2sunny/cloudy_01.png) | ![Cloudy2](samples/cloudy2sunny/cloudy_02.png) | ![Cloudy3](samples/cloudy2sunny/cloudy_03.png) |
| **å¤‰æ›å¾Œ** | **å¤‰æ›å¾Œ** | **å¤‰æ›å¾Œ** |
| ![Sunny1](samples/cloudy2sunny/sunny_01.png) | ![Sunny2](samples/cloudy2sunny/sunny_02.png) | ![Sunny3](samples/cloudy2sunny/sunny_03.png) |


## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

```
cycleGan-pytorch/
â”œâ”€â”€ cycle_gan.py          # æ¨è«–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ train.py              # è¨“ç·´ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ config/               # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â”œâ”€â”€ params.yaml       # æ¨è«–ç”¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
â”‚   â””â”€â”€ train.yaml        # è¨“ç·´ç”¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
â”œâ”€â”€ models/               # ãƒ¢ãƒ‡ãƒ«å®šç¾©
â”‚   â””â”€â”€ networks.py       # ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ»è­˜åˆ¥å™¨
â”œâ”€â”€ util/                 # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”œâ”€â”€ loss.py          # æå¤±é–¢æ•°
â”‚   â”œâ”€â”€ image_pool.py    # ç”»åƒãƒ—ãƒ¼ãƒ«
â”‚   â””â”€â”€ visualizer.py    # å¯è¦–åŒ–ãƒ»ãƒ­ã‚°
â”œâ”€â”€ samples/              # ã‚µãƒ³ãƒ—ãƒ«ç”»åƒ
â”‚   â”œâ”€â”€ sunny2cloudy/     # æ™´ã‚Œâ†’æ›‡ã‚Šå¤‰æ›ã‚µãƒ³ãƒ—ãƒ«
â”‚   â””â”€â”€ cloudy2sunny/     # æ›‡ã‚Šâ†’æ™´ã‚Œå¤‰æ›ã‚µãƒ³ãƒ—ãƒ«
â”œâ”€â”€ checkpoints/         # å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«
â”œâ”€â”€ datasets/            # ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ
â”œâ”€â”€ logs/               # è¨“ç·´ãƒ­ã‚°
â””â”€â”€ README.md
```

## å¿…è¦ç’°å¢ƒ

- Python 3.7+
- PyTorch 1.8+
- torchvision
- PIL (Pillow)
- PyYAML
- tqdm
- pathlib


## ä½¿ç”¨æ–¹æ³•

### 1. æ¨è«–ï¼ˆç”»åƒå¤‰æ›ï¼‰

å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ã£ã¦ç”»åƒå¤‰æ›ã‚’å®Ÿè¡Œï¼š

```bash
python3 cycle_gan.py <ç”»åƒãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª>
```

#### ä¾‹
```bash
# test_imagesãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ç”»åƒã‚’å¤‰æ›
python3 cycle_gan.py test_images

# çµæœã¯test_images_translatedãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã•ã‚Œã‚‹
```
æ³¨æ„ï¼šç”»åƒãƒ•ã‚©ãƒ«ãƒ€å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«åã¯00001.png, 00002.png, ...ã¨ç¶šãã“ã¨ãŒå‰æã¨ãªã£ã¦ã„ã¾ã™

#### å…¥åŠ›ãƒ»å‡ºåŠ›
- **å…¥åŠ›**: PNGç”»åƒãŒå«ã¾ã‚Œã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
- **å‡ºåŠ›**: å…ƒã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåã«`_translated`ã‚’ä»˜ã‘ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«å¤‰æ›çµæœã‚’ä¿å­˜

### 2. è¨“ç·´

æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ãƒ¢ãƒ‡ãƒ«ã‚’è¨“ç·´ï¼š

```bash
python3 train.py <ãƒ‰ãƒ¡ã‚¤ãƒ³Aç”»åƒãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª> <ãƒ‰ãƒ¡ã‚¤ãƒ³Bç”»åƒãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª>
```

æ³¨æ„ï¼šç”»åƒãƒ•ã‚©ãƒ«ãƒ€å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«åã¯00001.png, 00002.png, ...ã¨ç¶šãã“ã¨ãŒå‰æã¨ãªã£ã¦ã„ã¾ã™
#### ä¾‹
```bash
# sunnyç”»åƒã¨cloudyç”»åƒã§ãƒ¢ãƒ‡ãƒ«ã‚’è¨“ç·´
python3 train.py sunny_images cloudy_images
```

## è¨­å®š

### æ¨è«–è¨­å®š (config/params.yaml)

```yaml
checkpoint_path: "./checkpoints/sunny2cloudy/latest_net_G_A.pth"  # ãƒ¢ãƒ‡ãƒ«ãƒ‘ã‚¹
output_suffix: "_translated"    # å‡ºåŠ›ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ¥å°¾è¾
image_size: [200, 88]          # å‡¦ç†ç”»åƒã‚µã‚¤ã‚º [å¹…, é«˜ã•]
input_nc: 3                    # å…¥åŠ›ãƒãƒ£ãƒãƒ«æ•°
output_nc: 3                   # å‡ºåŠ›ãƒãƒ£ãƒãƒ«æ•°
n_blocks: 9                    # ResNetãƒ–ãƒ­ãƒƒã‚¯æ•°
use_dropout: false             # ãƒ‰ãƒ­ãƒƒãƒ—ã‚¢ã‚¦ãƒˆä½¿ç”¨
device: "cuda"                 # ä½¿ç”¨ãƒ‡ãƒã‚¤ã‚¹ ("cuda" or "cpu")
```

### è¨“ç·´è¨­å®š (config/train.yaml)

```yaml
epochs: 100                    # è¨“ç·´ã‚¨ãƒãƒƒã‚¯æ•°
image_size: [200, 88]         # ç”»åƒã‚µã‚¤ã‚º
name: "sunny2cloudy"          # ãƒ¢ãƒ‡ãƒ«å
```

## å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«

`checkpoints/sunny2cloudy/`ã«ä»¥ä¸‹ã®ãƒ¢ãƒ‡ãƒ«ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ï¼š
- `latest_net_G_A.pth`: Aâ†’Bï¼ˆæ™´â†’æ›‡ï¼‰ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿
- `latest_net_G_B.pth`: Bâ†’Aï¼ˆæ›‡â†’æ™´ï¼‰ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿  
- `latest_net_D_A.pth`: ãƒ‰ãƒ¡ã‚¤ãƒ³Aè­˜åˆ¥å™¨
- `latest_net_D_B.pth`: ãƒ‰ãƒ¡ã‚¤ãƒ³Bè­˜åˆ¥å™¨